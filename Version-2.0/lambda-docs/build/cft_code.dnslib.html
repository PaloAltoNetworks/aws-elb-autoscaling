

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cft_code.dnslib package &mdash; Palo Alto Networks AWS Autoscale 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Palo Alto Networks AWS Autoscale 2.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Palo Alto Networks AWS Autoscale
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Palo Alto Networks Lambda Functions for ELB AutoScale Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="arch.html">Architecture of the Palo Alto CFT Lambda Functions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Palo Alto Networks AWS Autoscale</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>cft_code.dnslib package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/cft_code.dnslib.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cft-code-dnslib-package">
<h1>cft_code.dnslib package<a class="headerlink" href="#cft-code-dnslib-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-cft_code.dnslib.bimap">
<span id="cft-code-dnslib-bimap-module"></span><h2>cft_code.dnslib.bimap module<a class="headerlink" href="#module-cft_code.dnslib.bimap" title="Permalink to this headline">¶</a></h2>
<p>Bimap - bidirectional mapping between code/value</p>
<dl class="class">
<dt id="cft_code.dnslib.bimap.Bimap">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.bimap.</code><code class="descname">Bimap</code><span class="sig-paren">(</span><em>name</em>, <em>forward</em>, <em>error=&lt;type 'exceptions.KeyError'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bimap.Bimap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Bi-directional mapping between code/text.</p>
<p>Initialised using:</p>
<blockquote>
<div>name:   Used for exceptions
dict:   Dict mapping from code (numeric) to text
error:  Error type to raise if key not found</div></blockquote>
<p>The class provides:</p>
<blockquote>
<div><ul class="simple">
<li>A ‘forward’ map (code-&gt;text) which is accessed through 
__getitem__ (bimap[code])</li>
<li>A ‘reverse’ map (code&gt;value) which is accessed through 
__getattr__ (bimap.text)</li>
<li>A ‘get’ method which does a forward lookup (code-&gt;text)
and returns a textual version of code if there is no
explicit mapping (or default provided)</li>
</ul>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TestError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span> <span class="o">=</span> <span class="n">Bimap</span><span class="p">(</span><span class="s1">&#39;TEST&#39;</span><span class="p">,{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">},</span><span class="n">TestError</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;A&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span><span class="o">.</span><span class="n">A</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span><span class="o">.</span><span class="n">X</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TestError</span>: <span class="n">TEST: Invalid reverse lookup: [X]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span><span class="p">[</span><span class="mi">99</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TestError</span>: <span class="n">TEST: Invalid forward lookup: [99]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TEST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">&#39;99&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="cft_code.dnslib.bimap.Bimap.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>k</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bimap.Bimap.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="cft_code.dnslib.bimap.BimapError">
<em class="property">exception </em><code class="descclassname">cft_code.dnslib.bimap.</code><code class="descname">BimapError</code><a class="headerlink" href="#cft_code.dnslib.bimap.BimapError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.bit">
<span id="cft-code-dnslib-bit-module"></span><h2>cft_code.dnslib.bit module<a class="headerlink" href="#module-cft_code.dnslib.bit" title="Permalink to this headline">¶</a></h2>
<p>Some basic bit mainpulation utilities</p>
<dl class="function">
<dt id="cft_code.dnslib.bit.binary">
<code class="descclassname">cft_code.dnslib.bit.</code><code class="descname">binary</code><span class="sig-paren">(</span><em>n</em>, <em>count=16</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bit.binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Display n in binary (only difference from built-in <cite>bin</cite> is
that this function returns a fixed width string and can
optionally be reversed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span><span class="p">(</span><span class="mi">6789</span><span class="p">)</span>
<span class="go">&#39;0001101010000101&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span><span class="p">(</span><span class="mi">6789</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="go">&#39;10000101&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary</span><span class="p">(</span><span class="mi">6789</span><span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;1010000101011000&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.bit.get_bits">
<code class="descclassname">cft_code.dnslib.bit.</code><code class="descname">get_bits</code><span class="sig-paren">(</span><em>data</em>, <em>offset</em>, <em>bits=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bit.get_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Get specified bits from integer</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bin</span><span class="p">(</span><span class="n">get_bits</span><span class="p">(</span><span class="mb">0b0011100</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&#39;0b1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bin</span><span class="p">(</span><span class="n">get_bits</span><span class="p">(</span><span class="mb">0b0011100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">&#39;0b1100&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.bit.hexdump">
<code class="descclassname">cft_code.dnslib.bit.</code><code class="descname">hexdump</code><span class="sig-paren">(</span><em>src</em>, <em>length=16</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bit.hexdump" title="Permalink to this definition">¶</a></dt>
<dd><p>Print hexdump of string</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">hexdump</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;abcd&quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">0000  61 62 63 64 61 62 63 64  61 62 63 64 61 62 63 64  abcdabcd abcdabcd</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">hexdump</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">))))</span>
<span class="go">0000  00 01 02 03 04 05 06 07  08 09 0a 0b 0c 0d 0e 0f  ........ ........</span>
<span class="go">0010  10 11 12 13 14 15 16 17  18 19 1a 1b 1c 1d 1e 1f  ........ ........</span>
<span class="go">0020  20 21 22 23 24 25 26 27  28 29 2a 2b 2c 2d 2e 2f   !&quot;#$%&amp;&#39; ()*+,-./</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.bit.set_bits">
<code class="descclassname">cft_code.dnslib.bit.</code><code class="descname">set_bits</code><span class="sig-paren">(</span><em>data</em>, <em>value</em>, <em>offset</em>, <em>bits=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.bit.set_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Set specified bits in integer</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bin</span><span class="p">(</span><span class="n">set_bits</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mb">0b1010</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">&#39;0b1010&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bin</span><span class="p">(</span><span class="n">set_bits</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mb">0b1010</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">&#39;0b1010000&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.buffer">
<span id="cft-code-dnslib-buffer-module"></span><h2>cft_code.dnslib.buffer module<a class="headerlink" href="#module-cft_code.dnslib.buffer" title="Permalink to this headline">¶</a></h2>
<p>Buffer - simple data buffer</p>
<dl class="class">
<dt id="cft_code.dnslib.buffer.Buffer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.buffer.</code><code class="descname">Buffer</code><span class="sig-paren">(</span><em>data=''</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A simple data buffer - supports packing/unpacking in struct format</p>
<p># Needed for Python 2/3 doctest compatibility
&gt;&gt;&gt; def p(s):
…     if not isinstance(s,str):
…         return s.decode()
…     return s</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Buffer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;!BHI&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;0123456789&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span>
<span class="go">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
<span class="go">&#39;0100020000000330313233343536373839&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;!BHI&quot;</span><span class="p">)</span>
<span class="go">(1, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">bytearray(b&#39;01234&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">bytearray(b&#39;56789&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="s2">&quot;2s&quot;</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;xx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytearray</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">bytearray(b&#39;xx234&#39;)</span>
</pre></div>
</div>
<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append s to end of data &amp; increment offset</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Gen len bytes at current offset (&amp; increment offset)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.hex">
<code class="descname">hex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data as hex string</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>fmt</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack data at end of data according to fmt (from struct) &amp; increment
offset</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.remaining">
<code class="descname">remaining</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bytes remaining</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.unpack">
<code class="descname">unpack</code><span class="sig-paren">(</span><em>fmt</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack data at current offset according to fmt (from struct)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.buffer.Buffer.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>ptr</em>, <em>fmt</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.buffer.Buffer.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify data at offset <cite>ptr</cite></p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="cft_code.dnslib.buffer.BufferError">
<em class="property">exception </em><code class="descclassname">cft_code.dnslib.buffer.</code><code class="descname">BufferError</code><a class="headerlink" href="#cft_code.dnslib.buffer.BufferError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.client">
<span id="cft-code-dnslib-client-module"></span><h2>cft_code.dnslib.client module<a class="headerlink" href="#module-cft_code.dnslib.client" title="Permalink to this headline">¶</a></h2>
<p>DNS Client - DiG-like CLI utility.</p>
<p>Mostly useful for testing. Can optionally compare results from two
nameservers (–diff) or compare results against DiG (–dig).</p>
<p>Usage: python -m dnslib.client [options|–help]</p>
<p>See –help for usage.</p>
</div>
<div class="section" id="module-cft_code.dnslib.digparser">
<span id="cft-code-dnslib-digparser-module"></span><h2>cft_code.dnslib.digparser module<a class="headerlink" href="#module-cft_code.dnslib.digparser" title="Permalink to this headline">¶</a></h2>
<div class="section" id="digparser">
<h3>digparser<a class="headerlink" href="#digparser" title="Permalink to this headline">¶</a></h3>
<p>Encode/decode DNS packets from DiG textual representation. Parses 
question (if present: +qr flag) &amp; answer sections and returns list 
of DNSRecord objects.</p>
<p>Unsupported RR types are skipped (this is different from the packet 
parser which will store and encode the RDATA as a binary blob)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dig</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;dig&quot;</span><span class="p">,</span><span class="s2">&quot;google.com-A.dig&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dig</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">l</span> <span class="o">=</span> <span class="n">DigParser</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>
<span class="go">---</span>
<span class="go">&lt;DNS Header: id=0x5c9a type=QUERY opcode=QUERY flags=RD rcode=&#39;NOERROR&#39; q=1 a=0 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=A qclass=IN&gt;</span>
<span class="go">---</span>
<span class="go">&lt;DNS Header: id=0x5c9a type=RESPONSE opcode=QUERY flags=RD,RA rcode=&#39;NOERROR&#39; q=1 a=16 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=A qclass=IN&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.183&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.152&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.172&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.177&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.157&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.153&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.182&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.168&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.178&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.162&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.187&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.167&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.148&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.173&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.158&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.163&#39;&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dig</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;dig&quot;</span><span class="p">,</span><span class="s2">&quot;google.com-ANY.dig&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dig</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">l</span> <span class="o">=</span> <span class="n">DigParser</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>
<span class="go">---</span>
<span class="go">&lt;DNS Header: id=0xfc6b type=QUERY opcode=QUERY flags=RD rcode=&#39;NOERROR&#39; q=1 a=0 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=ANY qclass=IN&gt;</span>
<span class="go">---</span>
<span class="go">&lt;DNS Header: id=0xa6fc type=QUERY opcode=QUERY flags=RD rcode=&#39;NOERROR&#39; q=1 a=0 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=ANY qclass=IN&gt;</span>
<span class="go">---</span>
<span class="go">&lt;DNS Header: id=0xa6fc type=RESPONSE opcode=QUERY flags=RD,RA rcode=&#39;NOERROR&#39; q=1 a=28 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=ANY qclass=IN&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.183&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.152&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.172&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.177&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.157&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.153&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.182&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.168&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.178&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.162&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.187&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.167&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.148&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.173&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.158&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=A rclass=IN ttl=299 rdata=&#39;62.252.169.163&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=NS rclass=IN ttl=21599 rdata=&#39;ns4.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=MX rclass=IN ttl=599 rdata=&#39;50 alt4.aspmx.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=NS rclass=IN ttl=21599 rdata=&#39;ns2.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=MX rclass=IN ttl=599 rdata=&#39;10 aspmx.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=NS rclass=IN ttl=21599 rdata=&#39;ns3.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=SOA rclass=IN ttl=21599 rdata=&#39;ns1.google.com. dns-admin.google.com. 2014021800 7200 1800 1209600 300&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=MX rclass=IN ttl=599 rdata=&#39;40 alt3.aspmx.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=MX rclass=IN ttl=599 rdata=&#39;20 alt1.aspmx.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=TYPE257 rclass=IN ttl=21599 rdata=&#39;0005697373756573796d616e7465632e636f6d&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=TXT rclass=IN ttl=3599 rdata=&#39;&quot;v=spf1 include:_spf.google.com ip4:216.73.93.70/31 ip4:216.73.93.72/31 ~all&quot;&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=MX rclass=IN ttl=599 rdata=&#39;30 alt2.aspmx.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;google.com.&#39; rtype=NS rclass=IN ttl=21599 rdata=&#39;ns1.google.com.&#39;&gt;</span>
</pre></div>
</div>
<dl class="class">
<dt id="cft_code.dnslib.digparser.DigParser">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.digparser.</code><code class="descname">DigParser</code><span class="sig-paren">(</span><em>dig</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse Dig output</p>
<dl class="method">
<dt id="cft_code.dnslib.digparser.DigParser.expect">
<code class="descname">expect</code><span class="sig-paren">(</span><em>expect</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser.expect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.digparser.DigParser.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.digparser.DigParser.parseAnswers">
<code class="descname">parseAnswers</code><span class="sig-paren">(</span><em>a</em>, <em>auth</em>, <em>ar</em>, <em>dns</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser.parseAnswers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.digparser.DigParser.parseHeader">
<code class="descname">parseHeader</code><span class="sig-paren">(</span><em>l1</em>, <em>l2</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser.parseHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.digparser.DigParser.parseQuestions">
<code class="descname">parseQuestions</code><span class="sig-paren">(</span><em>q</em>, <em>dns</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.digparser.DigParser.parseQuestions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-cft_code.dnslib.dns">
<span id="cft-code-dnslib-dns-module"></span><h2>cft_code.dnslib.dns module<a class="headerlink" href="#module-cft_code.dnslib.dns" title="Permalink to this headline">¶</a></h2>
<p>DNS - main dnslib module</p>
<p>Contains core DNS packet handling code</p>
<dl class="class">
<dt id="cft_code.dnslib.dns.A">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">A</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.A" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.A.data">
<code class="descname">data</code><a class="headerlink" href="#cft_code.dnslib.dns.A.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.A.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.A.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.A.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.A.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.A.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.A.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.AAAA">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">AAAA</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.AAAA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<p>Basic support for AAAA record - accepts IPv6 address data as either
a tuple of 16 bytes or in text format</p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.AAAA.data">
<code class="descname">data</code><a class="headerlink" href="#cft_code.dnslib.dns.AAAA.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.AAAA.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.AAAA.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.AAAA.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.AAAA.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.AAAA.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.AAAA.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.CNAME">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">CNAME</code><span class="sig-paren">(</span><em>label=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.CNAME.attrs">
<code class="descname">attrs</code><em class="property"> = ('label',)</em><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.CNAME.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.CNAME.get_label">
<code class="descname">get_label</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.get_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.CNAME.label">
<code class="descname">label</code><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.CNAME.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.CNAME.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.CNAME.set_label">
<code class="descname">set_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.CNAME.set_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="cft_code.dnslib.dns.DNSError">
<em class="property">exception </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">DNSError</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.DNSHeader">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">DNSHeader</code><span class="sig-paren">(</span><em>id=None</em>, <em>bitmap=None</em>, <em>q=0</em>, <em>a=0</em>, <em>auth=0</em>, <em>ar=0</em>, <em>**args</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>DNSHeader section</p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.a">
<code class="descname">a</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.aa">
<code class="descname">aa</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.aa" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.ar">
<code class="descname">ar</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.ar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.auth">
<code class="descname">auth</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.auth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.bitmap">
<code class="descname">bitmap</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.bitmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_aa">
<code class="descname">get_aa</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_aa" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_opcode">
<code class="descname">get_opcode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_opcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_qr">
<code class="descname">get_qr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_qr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_ra">
<code class="descname">get_ra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_ra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_rcode">
<code class="descname">get_rcode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_rcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_rd">
<code class="descname">get_rd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_rd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.get_tc">
<code class="descname">get_tc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.get_tc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.id">
<code class="descname">id</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.opcode">
<code class="descname">opcode</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.opcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSHeader.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements parse interface</p>
</dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.q">
<code class="descname">q</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.q" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.qr">
<code class="descname">qr</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.qr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.ra">
<code class="descname">ra</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.ra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.rcode">
<code class="descname">rcode</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.rcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.rd">
<code class="descname">rd</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.rd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_aa">
<code class="descname">set_aa</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_aa" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_opcode">
<code class="descname">set_opcode</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_opcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_qr">
<code class="descname">set_qr</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_qr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_ra">
<code class="descname">set_ra</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_ra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_rcode">
<code class="descname">set_rcode</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_rcode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_rd">
<code class="descname">set_rd</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_rd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.set_tc">
<code class="descname">set_tc</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.set_tc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSHeader.tc">
<code class="descname">tc</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.tc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSHeader.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSHeader.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.DNSKEY">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">DNSKEY</code><span class="sig-paren">(</span><em>flags</em>, <em>protocol</em>, <em>algorithm</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSKEY.algorithm">
<code class="descname">algorithm</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.algorithm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSKEY.attrs">
<code class="descname">attrs</code><em class="property"> = ('flags', 'protocol', 'algorithm', 'key')</em><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSKEY.flags">
<code class="descname">flags</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSKEY.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSKEY.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSKEY.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSKEY.protocol">
<code class="descname">protocol</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSKEY.protocol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.DNSQuestion">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">DNSQuestion</code><span class="sig-paren">(</span><em>qname=None</em>, <em>qtype=1</em>, <em>qclass=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>DNSQuestion section</p>
<dl class="method">
<dt id="cft_code.dnslib.dns.DNSQuestion.get_qname">
<code class="descname">get_qname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.get_qname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSQuestion.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSQuestion.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSQuestion.qname">
<code class="descname">qname</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.qname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSQuestion.set_qname">
<code class="descname">set_qname</code><span class="sig-paren">(</span><em>qname</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.set_qname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSQuestion.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSQuestion.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.DNSRecord">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">DNSRecord</code><span class="sig-paren">(</span><em>header=None</em>, <em>questions=None</em>, <em>rr=None</em>, <em>q=None</em>, <em>a=None</em>, <em>auth=None</em>, <em>ar=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Main DNS class - corresponds to DNS packet &amp; comprises DNSHeader, 
DNSQuestion and RR sections (answer,ns,ar)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">add_question</span><span class="p">(</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">))</span> <span class="c1"># Or DNSRecord.question(&quot;abc.com&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">CNAME</span><span class="p">,</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">CNAME</span><span class="p">(</span><span class="s2">&quot;ns.abc.com&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">add_auth</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">SOA</span><span class="p">,</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">SOA</span><span class="p">(</span><span class="s2">&quot;ns.abc.com&quot;</span><span class="p">,</span><span class="s2">&quot;admin.abc.com&quot;</span><span class="p">,(</span><span class="mi">20140101</span><span class="p">,</span><span class="mi">3600</span><span class="p">,</span><span class="mi">3600</span><span class="p">,</span><span class="mi">3600</span><span class="p">,</span><span class="mi">3600</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">add_ar</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;ns.abc.com&quot;</span><span class="p">,</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      CNAME   ns.abc.com.</span>
<span class="go">;; AUTHORITY SECTION:</span>
<span class="go">abc.com.                60      IN      SOA     ns.abc.com. admin.abc.com. 20140101 3600 3600 3600 3600</span>
<span class="go">;; ADDITIONAL SECTION:</span>
<span class="go">ns.abc.com.             60      IN      A       1.2.3.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSRecord.a">
<code class="descname">a</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.add_answer">
<code class="descname">add_answer</code><span class="sig-paren">(</span><em>*rr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.add_answer" title="Permalink to this definition">¶</a></dt>
<dd><p>Add answer(s)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com A 1.2.3.4&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                0       IN      A       1.2.3.4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.add_ar">
<code class="descname">add_ar</code><span class="sig-paren">(</span><em>*ar</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.add_ar" title="Permalink to this definition">¶</a></dt>
<dd><p>Add additional records</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com 60 CNAME x.abc.com&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_ar</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;x.abc.com 3600 A 1.2.3.4&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      CNAME   x.abc.com.</span>
<span class="go">;; ADDITIONAL SECTION:</span>
<span class="go">x.abc.com.              3600    IN      A       1.2.3.4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.add_auth">
<code class="descname">add_auth</code><span class="sig-paren">(</span><em>*auth</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.add_auth" title="Permalink to this definition">¶</a></dt>
<dd><p>Add authority records</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com 60 A 1.2.3.4&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_auth</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com 3600 NS nsa.abc.com&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      A       1.2.3.4</span>
<span class="go">;; AUTHORITY SECTION:</span>
<span class="go">abc.com.                3600    IN      NS      nsa.abc.com.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.add_question">
<code class="descname">add_question</code><span class="sig-paren">(</span><em>*q</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.add_question" title="Permalink to this definition">¶</a></dt>
<dd><p>Add question(s)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">add_question</span><span class="p">(</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">MX</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 2, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;abc.com.                       IN      MX</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.diff">
<code class="descname">diff</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Diff records - recursively diff sections (sorting RRs)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>prefix=''</em>, <em>sort=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Formatted ‘repr’-style representation of record
(optionally with prefix and/or sorted RRs)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.get_a">
<code class="descname">get_a</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.get_a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.get_q">
<code class="descname">get_q</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.get_q" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack record into binary packet
(recursively packs each section into buffer)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">replyZone</span><span class="p">(</span><span class="s2">&quot;abc.com A 1.2.3.4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">aa</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pkt</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">pkt</span><span class="p">))</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 1234</span>
<span class="go">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                0       IN      A       1.2.3.4</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSRecord.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>packet</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse DNS packet data and return DNSRecord instance
Recursively parses sections (calling appropriate parse method)</p>
</dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.DNSRecord.q">
<code class="descname">q</code><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.q" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.DNSRecord.question">
<em class="property">classmethod </em><code class="descname">question</code><span class="sig-paren">(</span><em>qname</em>, <em>qtype='A'</em>, <em>qclass='IN'</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.question" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to create question</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;www.google.com.                IN      A</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">,</span><span class="s2">&quot;NS&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;www.google.com.                IN      NS</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.reply">
<code class="descname">reply</code><span class="sig-paren">(</span><em>ra=1</em>, <em>aa=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.reply" title="Permalink to this definition">¶</a></dt>
<dd><p>Create skeleton reply packet</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">),</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      A       1.2.3.4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.replyZone">
<code class="descname">replyZone</code><span class="sig-paren">(</span><em>zone</em>, <em>ra=1</em>, <em>aa=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.replyZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Create reply with response data in zone-file format
&gt;&gt;&gt; q = DNSRecord.question(“abc.com”)
&gt;&gt;&gt; a = q.replyZone(“abc.com 60 A 1.2.3.4”)
&gt;&gt;&gt; print(a)
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: …
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;abc.com.                       IN      A
;; ANSWER SECTION:
abc.com.                60      IN      A       1.2.3.4</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.send">
<code class="descname">send</code><span class="sig-paren">(</span><em>dest</em>, <em>port=53</em>, <em>tcp=False</em>, <em>timeout=None</em>, <em>ipv6=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send packet to nameserver and return response</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.set_header_qa">
<code class="descname">set_header_qa</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.set_header_qa" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset header q/a/auth/ar counts to match numver of records
(normally done transparently)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.short">
<code class="descname">short</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.short" title="Permalink to this definition">¶</a></dt>
<dd><p>Just return RDATA</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.toZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Formatted ‘DiG’ (zone) style output 
(with optional prefix)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.DNSRecord.truncate">
<code class="descname">truncate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.DNSRecord.truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return truncated copy of DNSRecord (with TC flag set)
(removes all Questions &amp; RRs and just returns header)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s1">&#39;abc.com IN TXT </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s1">&#39;abc.com IN TXT </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s1">&#39;abc.com IN TXT </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pack</span><span class="p">())</span>
<span class="go">829</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa tc rd ra; QUERY: 0, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.EDNS0">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">EDNS0</code><span class="sig-paren">(</span><em>rname=None</em>, <em>rtype=41</em>, <em>ext_rcode=0</em>, <em>version=0</em>, <em>flags=''</em>, <em>udp_len=0</em>, <em>opts=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.EDNS0" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RR" title="cft_code.dnslib.dns.RR"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RR</span></code></a></p>
<p>ENDS0 pseudo-record</p>
<p>Wrapper around the ENDS0 support in RR to make it more convenient to
create EDNS0 pseudo-record - this just makes it easier to specify the
EDNS0 parameters directly</p>
<p>EDNS flags should be passed as a space separated string of options 
(currently only ‘do’ is supported)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EDNS0</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="s2">&quot;do&quot;</span><span class="p">,</span><span class="n">udp_len</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&lt;DNS OPT: edns_ver=1 do=1 ext_rcode=0 udp_len=2048&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">;OPT PSEUDOSECTION</span>
<span class="go">;EDNS: version: 1, flags: do; udp: 2048</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt</span> <span class="o">=</span> <span class="n">EDNS0</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">flags</span><span class="o">=</span><span class="s2">&quot;do&quot;</span><span class="p">,</span><span class="n">ext_rcode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">udp_len</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">opts</span><span class="o">=</span><span class="p">[</span><span class="n">EDNSOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;abcd&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt</span>
<span class="go">&lt;DNS OPT: edns_ver=1 do=1 ext_rcode=1 udp_len=2048&gt;</span>
<span class="go">&lt;EDNS Option: Code=1 Data=&#39;61626364&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
<span class="go">;OPT PSEUDOSECTION</span>
<span class="go">;EDNS: version: 1, flags: do; udp: 2048</span>
<span class="go">;EDNS: code: 1; data: 61626364</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replyZone</span><span class="p">(</span><span class="s2">&quot;abc.com A 1.2.3.4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">add_ar</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                0       IN      A       1.2.3.4</span>
<span class="go">;; ADDITIONAL SECTION:</span>
<span class="go">;OPT PSEUDOSECTION</span>
<span class="go">;EDNS: version: 1, flags: do; udp: 2048</span>
<span class="go">;EDNS: code: 1; data: 61626364</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">pack</span><span class="p">())</span> <span class="o">==</span> <span class="n">r</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.EDNSOption">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">EDNSOption</code><span class="sig-paren">(</span><em>code</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.EDNSOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>EDNSOption pseudo-section</p>
<p>Very rudimentary support for EDNS0 options however this has not been
tested due to a lack of data (anyone wanting to improve support or
provide test data please raise an issue)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EDNSOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;1234&quot;</span><span class="p">)</span>
<span class="go">&lt;EDNS Option: Code=1 Data=&#39;31323334&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EDNSOption</span><span class="p">(</span><span class="mi">99999</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;1234&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;code&#39; must be between 0-65535 [99999]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EDNSOption</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;data&#39; must be instance of ...</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.EDNSOption.code">
<code class="descname">code</code><a class="headerlink" href="#cft_code.dnslib.dns.EDNSOption.code" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.EDNSOption.data">
<code class="descname">data</code><a class="headerlink" href="#cft_code.dnslib.dns.EDNSOption.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.EDNSOption.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.EDNSOption.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.EDNSOption.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.EDNSOption.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.MX">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">MX</code><span class="sig-paren">(</span><em>label=None</em>, <em>preference=10</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.MX.attrs">
<code class="descname">attrs</code><em class="property"> = ('preference', 'label')</em><a class="headerlink" href="#cft_code.dnslib.dns.MX.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.MX.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.MX.get_label">
<code class="descname">get_label</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX.get_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.MX.label">
<code class="descname">label</code><a class="headerlink" href="#cft_code.dnslib.dns.MX.label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.MX.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.MX.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.MX.preference">
<code class="descname">preference</code><a class="headerlink" href="#cft_code.dnslib.dns.MX.preference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.MX.set_label">
<code class="descname">set_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.MX.set_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.NAPTR">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">NAPTR</code><span class="sig-paren">(</span><em>order</em>, <em>preference</em>, <em>flags</em>, <em>service</em>, <em>regexp</em>, <em>replacement=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.NAPTR.attrs">
<code class="descname">attrs</code><em class="property"> = ('order', 'preference', 'flags', 'service', 'regexp', 'replacement')</em><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.NAPTR.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.NAPTR.get_replacement">
<code class="descname">get_replacement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.get_replacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.NAPTR.order">
<code class="descname">order</code><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.NAPTR.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.NAPTR.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.NAPTR.preference">
<code class="descname">preference</code><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.preference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.NAPTR.replacement">
<code class="descname">replacement</code><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.replacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.NAPTR.set_replacement">
<code class="descname">set_replacement</code><span class="sig-paren">(</span><em>replacement</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NAPTR.set_replacement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.NS">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">NS</code><span class="sig-paren">(</span><em>label=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.NS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.CNAME" title="cft_code.dnslib.dns.CNAME"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.CNAME</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.PTR">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">PTR</code><span class="sig-paren">(</span><em>label=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.PTR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.CNAME" title="cft_code.dnslib.dns.CNAME"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.CNAME</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.RD">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">RD</code><span class="sig-paren">(</span><em>data=''</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base RD object - also used as placeholder for unknown RD types</p>
<p>To create a new RD type subclass this and add to RDMAP (below)</p>
<p>Subclass should implement (as a mininum):</p>
<blockquote>
<div><p>parse (parse from packet data)
__init__ (create class)
__repr__ (return in zone format)
fromZone (create from zone format)</p>
<p>(toZone uses __repr__ by default)</p>
</div></blockquote>
<p>Unknown rdata types default to RD and store rdata as a binary
blob (this allows round-trip encoding/decoding)</p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.RD.attrs">
<code class="descname">attrs</code><em class="property"> = ('data',)</em><a class="headerlink" href="#cft_code.dnslib.dns.RD.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RD.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RD.fromZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new record from zone format data
RD is a list of strings parsed from DiG output</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RD.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RD.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack record into buffer</p>
</dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RD.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RD.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack from buffer</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RD.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RD.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.RR">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">RR</code><span class="sig-paren">(</span><em>rname=None</em>, <em>rtype=1</em>, <em>rclass=1</em>, <em>ttl=0</em>, <em>rdata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>DNS Resource Record 
Contains RR header and RD (resource data) instance</p>
<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RR.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>zone</em>, <em>origin=''</em>, <em>ttl=0</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.fromZone" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse RR data from zone file and return list of RRs</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RR.get_rname">
<code class="descname">get_rname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.get_rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RR.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RR.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RR.rclass">
<code class="descname">rclass</code><a class="headerlink" href="#cft_code.dnslib.dns.RR.rclass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RR.rdlength">
<code class="descname">rdlength</code><a class="headerlink" href="#cft_code.dnslib.dns.RR.rdlength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RR.rname">
<code class="descname">rname</code><a class="headerlink" href="#cft_code.dnslib.dns.RR.rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RR.rtype">
<code class="descname">rtype</code><a class="headerlink" href="#cft_code.dnslib.dns.RR.rtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RR.set_rname">
<code class="descname">set_rname</code><span class="sig-paren">(</span><em>rname</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.set_rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RR.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RR.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RR.ttl">
<code class="descname">ttl</code><a class="headerlink" href="#cft_code.dnslib.dns.RR.ttl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.RRSIG">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">RRSIG</code><span class="sig-paren">(</span><em>covered</em>, <em>algorithm</em>, <em>labels</em>, <em>orig_ttl</em>, <em>sig_exp</em>, <em>sig_inc</em>, <em>key_tag</em>, <em>name</em>, <em>sig</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.algorithm">
<code class="descname">algorithm</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.algorithm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.attrs">
<code class="descname">attrs</code><em class="property"> = ('covered', 'algorithm', 'labels', 'orig_ttl', 'sig_exp', 'sig_inc', 'key_tag', 'name', 'sig')</em><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.covered">
<code class="descname">covered</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.covered" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RRSIG.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.key_tag">
<code class="descname">key_tag</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.key_tag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.labels">
<code class="descname">labels</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.orig_ttl">
<code class="descname">orig_ttl</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.orig_ttl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.RRSIG.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.RRSIG.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.sig_exp">
<code class="descname">sig_exp</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.sig_exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.RRSIG.sig_inc">
<code class="descname">sig_inc</code><a class="headerlink" href="#cft_code.dnslib.dns.RRSIG.sig_inc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.SOA">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">SOA</code><span class="sig-paren">(</span><em>mname=None</em>, <em>rname=None</em>, <em>times=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.SOA.attrs">
<code class="descname">attrs</code><em class="property"> = ('mname', 'rname', 'times')</em><a class="headerlink" href="#cft_code.dnslib.dns.SOA.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.SOA.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SOA.get_mname">
<code class="descname">get_mname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.get_mname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SOA.get_rname">
<code class="descname">get_rname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.get_rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SOA.mname">
<code class="descname">mname</code><a class="headerlink" href="#cft_code.dnslib.dns.SOA.mname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SOA.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.SOA.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SOA.rname">
<code class="descname">rname</code><a class="headerlink" href="#cft_code.dnslib.dns.SOA.rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SOA.set_mname">
<code class="descname">set_mname</code><span class="sig-paren">(</span><em>mname</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.set_mname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SOA.set_rname">
<code class="descname">set_rname</code><span class="sig-paren">(</span><em>rname</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SOA.set_rname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SOA.times">
<code class="descname">times</code><a class="headerlink" href="#cft_code.dnslib.dns.SOA.times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.SRV">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">SRV</code><span class="sig-paren">(</span><em>priority=0</em>, <em>weight=0</em>, <em>port=0</em>, <em>target=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<dl class="attribute">
<dt id="cft_code.dnslib.dns.SRV.attrs">
<code class="descname">attrs</code><em class="property"> = ('priority', 'weight', 'port', 'target')</em><a class="headerlink" href="#cft_code.dnslib.dns.SRV.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.SRV.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SRV.get_target">
<code class="descname">get_target</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV.get_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SRV.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.SRV.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SRV.port">
<code class="descname">port</code><a class="headerlink" href="#cft_code.dnslib.dns.SRV.port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SRV.priority">
<code class="descname">priority</code><a class="headerlink" href="#cft_code.dnslib.dns.SRV.priority" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.SRV.set_target">
<code class="descname">set_target</code><span class="sig-paren">(</span><em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.SRV.set_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SRV.target">
<code class="descname">target</code><a class="headerlink" href="#cft_code.dnslib.dns.SRV.target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.dns.SRV.weight">
<code class="descname">weight</code><a class="headerlink" href="#cft_code.dnslib.dns.SRV.weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.TXT">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">TXT</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.TXT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.dns.RD" title="cft_code.dnslib.dns.RD"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.dns.RD</span></code></a></p>
<p>DNS TXT record. Pass in either a single string, or a tuple/list of strings.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TXT</span><span class="p">(</span><span class="s1">&#39;txtvers=1&#39;</span><span class="p">)</span>
<span class="go">&quot;txtvers=1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TXT</span><span class="p">((</span><span class="s1">&#39;txtvers=1&#39;</span><span class="p">,))</span>
<span class="go">&quot;txtvers=1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TXT</span><span class="p">([</span><span class="s1">&#39;txtvers=1&#39;</span><span class="p">,])</span>
<span class="go">&quot;txtvers=1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TXT</span><span class="p">([</span><span class="s1">&#39;txtvers=1&#39;</span><span class="p">,</span><span class="s1">&#39;swver=2.5&#39;</span><span class="p">])</span>
<span class="go">&quot;txtvers=1&quot;,&quot;swver=2.5&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s1">&#39;example.com 60 IN TXT &quot;txtvers=1&quot;&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s1">&#39;example.com 120 IN TXT &quot;txtvers=1&quot; &quot;swver=2.3&quot;&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 0, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">example.com.            60      IN      TXT     &quot;txtvers=1&quot;</span>
<span class="go">example.com.            120     IN      TXT     &quot;txtvers=1&quot; &quot;swver=2.3&quot;</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="cft_code.dnslib.dns.TXT.fromZone">
<em class="property">classmethod </em><code class="descname">fromZone</code><span class="sig-paren">(</span><em>rd</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.TXT.fromZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.TXT.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.TXT.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cft_code.dnslib.dns.TXT.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>buffer</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.TXT.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.TXT.toZone">
<code class="descname">toZone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.TXT.toZone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.dns.ZoneParser">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">ZoneParser</code><span class="sig-paren">(</span><em>zone</em>, <em>origin=''</em>, <em>ttl=0</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.ZoneParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Zone file parser</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">ZoneParser</span><span class="p">(</span><span class="s2">&quot;www.example.com. 60 IN A 1.2.3.4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">parse</span><span class="p">())</span>
<span class="go">[&lt;DNS RR: &#39;www.example.com.&#39; rtype=A rclass=IN ttl=60 rdata=&#39;1.2.3.4&#39;&gt;]</span>
</pre></div>
</div>
<dl class="method">
<dt id="cft_code.dnslib.dns.ZoneParser.expect">
<code class="descname">expect</code><span class="sig-paren">(</span><em>expect</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.ZoneParser.expect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.ZoneParser.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.ZoneParser.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.ZoneParser.parse_label">
<code class="descname">parse_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.ZoneParser.parse_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.dns.ZoneParser.parse_rr">
<code class="descname">parse_rr</code><span class="sig-paren">(</span><em>rr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.ZoneParser.parse_rr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.dns.label">
<code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">label</code><span class="sig-paren">(</span><em>label</em>, <em>origin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.dns.parse_time">
<code class="descclassname">cft_code.dnslib.dns.</code><code class="descname">parse_time</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.dns.parse_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse time spec with optional s/m/h/d/w suffix</p>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.fixedresolver">
<span id="cft-code-dnslib-fixedresolver-module"></span><h2>cft_code.dnslib.fixedresolver module<a class="headerlink" href="#module-cft_code.dnslib.fixedresolver" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>FixedResolver - example resolver which responds with fixed response</dt>
<dd>to all requests</dd>
</dl>
<dl class="class">
<dt id="cft_code.dnslib.fixedresolver.FixedResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.fixedresolver.</code><code class="descname">FixedResolver</code><span class="sig-paren">(</span><em>zone</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.fixedresolver.FixedResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.BaseResolver</span></code></p>
<p>Respond with fixed response to all requests</p>
<dl class="method">
<dt id="cft_code.dnslib.fixedresolver.FixedResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.fixedresolver.FixedResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.intercept">
<span id="cft-code-dnslib-intercept-module"></span><h2>cft_code.dnslib.intercept module<a class="headerlink" href="#module-cft_code.dnslib.intercept" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>InterceptResolver - proxy requests to upstream server </dt>
<dd>(optionally intercepting)</dd>
</dl>
<dl class="class">
<dt id="cft_code.dnslib.intercept.InterceptResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.intercept.</code><code class="descname">InterceptResolver</code><span class="sig-paren">(</span><em>address</em>, <em>port</em>, <em>ttl</em>, <em>intercept</em>, <em>skip</em>, <em>nxdomain</em>, <em>timeout=0</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.intercept.InterceptResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.BaseResolver</span></code></p>
<p>Intercepting resolver</p>
<p>Proxy requests to upstream server optionally intercepting requests
matching local records</p>
<dl class="method">
<dt id="cft_code.dnslib.intercept.InterceptResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.intercept.InterceptResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.label">
<span id="cft-code-dnslib-label-module"></span><h2>cft_code.dnslib.label module<a class="headerlink" href="#module-cft_code.dnslib.label" title="Permalink to this headline">¶</a></h2>
<p>DNSLabel/DNSBuffer - DNS label handling &amp; encoding/decoding</p>
<dl class="class">
<dt id="cft_code.dnslib.label.DNSBuffer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.label.</code><code class="descname">DNSBuffer</code><span class="sig-paren">(</span><em>data=''</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.buffer.Buffer</span></code></p>
<p>Extends Buffer to provide DNS name encoding/decoding (with caching)</p>
<p># Needed for Python 2/3 doctest compatibility
&gt;&gt;&gt; def p(s):
…     if not isinstance(s,str):
…         return s.decode()
…     return s</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">DNSBuffer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;aaa.bbb.ccc.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;aaa.bbb.ccc.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;xxx.yyy.zzz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">28</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;zzz.xxx.bbb.ccc.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">38</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;aaa.xxx.bbb.ccc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">44</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">aaa.bbb.ccc.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">aaa.bbb.ccc.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">xxx.yyy.zzz.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">zzz.xxx.bbb.ccc.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">aaa.xxx.bbb.ccc.</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">DNSBuffer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;a.aa&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;b.bb&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;c.cc&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">()</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">DNSBuffer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name_nocompress</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;aaa.bbb.ccc.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">encode_name_nocompress</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;aaa.bbb.ccc.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">26</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">aaa.bbb.ccc.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">decode_name</span><span class="p">())</span>
<span class="go">aaa.bbb.ccc.</span>
</pre></div>
</div>
<dl class="method">
<dt id="cft_code.dnslib.label.DNSBuffer.decode_name">
<code class="descname">decode_name</code><span class="sig-paren">(</span><em>last=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSBuffer.decode_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode label at current offset in buffer (following pointers
to cached elements where necessary)</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSBuffer.encode_name">
<code class="descname">encode_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSBuffer.encode_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode label and store at end of buffer (compressing
cached elements where needed) and store elements
in ‘names’ dict</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSBuffer.encode_name_nocompress">
<code class="descname">encode_name_nocompress</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSBuffer.encode_name_nocompress" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode and store label with no compression 
(needed for RRSIG)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.label.DNSLabel">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.label.</code><code class="descname">DNSLabel</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Container for DNS label</p>
<p>Supports IDNA encoding for unicode domain names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">=</span> <span class="n">DNSLabel</span><span class="p">(</span><span class="s2">&quot;aaa.bbb.ccc.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2</span> <span class="o">=</span> <span class="n">DNSLabel</span><span class="p">([</span><span class="sa">b</span><span class="s2">&quot;aaa&quot;</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;bbb&quot;</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;ccc&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">==</span> <span class="n">l2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span> <span class="o">=</span> <span class="n">DNSLabel</span><span class="p">(</span><span class="s2">&quot;AAA.BBB.CCC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">==</span> <span class="n">l3</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">==</span> <span class="s1">&#39;AAA.BBB.CCC&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span> <span class="n">l1</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="n">l1</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span>
<span class="go">&lt;DNSLabel: &#39;aaa.bbb.ccc.&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="go">&#39;aaa.bbb.ccc.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span> <span class="o">=</span> <span class="n">l1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;xxx.yyy&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span>
<span class="go">&lt;DNSLabel: &#39;xxx.yyy.aaa.bbb.ccc.&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span><span class="o">.</span><span class="n">matchSuffix</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span><span class="o">.</span><span class="n">matchSuffix</span><span class="p">(</span><span class="s2">&quot;xxx.yyy.&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span><span class="o">.</span><span class="n">stripSuffix</span><span class="p">(</span><span class="s2">&quot;bbb.ccc.&quot;</span><span class="p">)</span>
<span class="go">&lt;DNSLabel: &#39;xxx.yyy.aaa.&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span><span class="o">.</span><span class="n">matchGlob</span><span class="p">(</span><span class="s2">&quot;*.[abc]aa.BBB.ccc&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span><span class="o">.</span><span class="n">matchGlob</span><span class="p">(</span><span class="s2">&quot;*.[abc]xx.bbb.ccc&quot;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p># Too hard to get unicode doctests to work on Python 3.2  
# (works on 3.3)
# &gt;&gt;&gt; u1 = DNSLabel(u’u2295.com’)
# &gt;&gt;&gt; u1.__str__() == u’u2295.com.’
# True
# &gt;&gt;&gt; u1.label == ( b”xn–keh”, b”com” )
# True</p>
<dl class="method">
<dt id="cft_code.dnslib.label.DNSLabel.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepend name to label</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSLabel.idna">
<code class="descname">idna</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel.idna" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSLabel.matchGlob">
<code class="descname">matchGlob</code><span class="sig-paren">(</span><em>pattern</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel.matchGlob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSLabel.matchSuffix">
<code class="descname">matchSuffix</code><span class="sig-paren">(</span><em>suffix</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel.matchSuffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if label suffix matches</p>
</dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.label.DNSLabel.stripSuffix">
<code class="descname">stripSuffix</code><span class="sig-paren">(</span><em>suffix</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.label.DNSLabel.stripSuffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip suffix from label</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="cft_code.dnslib.label.DNSLabelError">
<em class="property">exception </em><code class="descclassname">cft_code.dnslib.label.</code><code class="descname">DNSLabelError</code><a class="headerlink" href="#cft_code.dnslib.label.DNSLabelError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.lex">
<span id="cft-code-dnslib-lex-module"></span><h2>cft_code.dnslib.lex module<a class="headerlink" href="#module-cft_code.dnslib.lex" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cft_code.dnslib.lex.Lexer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.lex.</code><code class="descname">Lexer</code><span class="sig-paren">(</span><em>f</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Simple Lexer base class. Provides basic lexer framework and 
helper functionality (read/peek/pushback etc)</p>
<p>Each state is implemented using a method (lexXXXX) which should
match a single token and return a (token,lexYYYY) tuple, with lexYYYY
representing the next state. If token is None this is not emitted
and if lexYYYY is None or the lexer reaches the end of the 
input stream the lexer exits.</p>
<p>The ‘parse’ method returns a generator that will return tokens
(the class also acts as an iterator)</p>
<p>The default start state is ‘lexStart’</p>
<p>Input can either be a string/bytes or file object.</p>
<p>The approach is based loosely on Rob Pike’s Go lexer presentation
(using generators rather than channels).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Lexer</span><span class="p">(</span><span class="s2">&quot;a bcd efgh&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39; &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;bcd&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&#39;bcd e&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">pushback</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">&#39;efgh&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="cft_code.dnslib.lex.Lexer.escape">
<code class="descname">escape</code><em class="property"> = {'r': '\r', 't': '\t', 'n': '\n'}</em><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.escape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.Lexer.escape_chars">
<code class="descname">escape_chars</code><em class="property"> = '\\'</em><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.escape_chars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.lexStart">
<code class="descname">lexStart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.lexStart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.next_token">
<code class="descname">next_token</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.next_token" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.peek">
<code class="descname">peek</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.peek" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.pushback">
<code class="descname">pushback</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.pushback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.Lexer.readescaped">
<code class="descname">readescaped</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.Lexer.readescaped" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.lex.RandomLexer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.lex.</code><code class="descname">RandomLexer</code><span class="sig-paren">(</span><em>f</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.lex.Lexer" title="cft_code.dnslib.lex.Lexer"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.lex.Lexer</span></code></a></p>
<p>Test lexing from infinite stream.</p>
<p>Extract strings of letters/numbers from /dev/urandom</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span><span class="o">,</span><span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/dev/urandom&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/dev/urandom&quot;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ascii&quot;</span><span class="p">,</span><span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">RandomLexer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">10</span>
</pre></div>
</div>
<dl class="method">
<dt id="cft_code.dnslib.lex.RandomLexer.lexAlpha">
<code class="descname">lexAlpha</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.lexAlpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.RandomLexer.lexDigits">
<code class="descname">lexDigits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.lexDigits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.RandomLexer.lexRandom">
<code class="descname">lexRandom</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.lexRandom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.RandomLexer.lexStart">
<code class="descname">lexStart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.lexStart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.RandomLexer.minalpha">
<code class="descname">minalpha</code><em class="property"> = 4</em><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.minalpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.RandomLexer.mindigits">
<code class="descname">mindigits</code><em class="property"> = 3</em><a class="headerlink" href="#cft_code.dnslib.lex.RandomLexer.mindigits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.lex.WordLexer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.lex.</code><code class="descname">WordLexer</code><span class="sig-paren">(</span><em>f</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cft_code.dnslib.lex.Lexer" title="cft_code.dnslib.lex.Lexer"><code class="xref py py-class docutils literal"><span class="pre">cft_code.dnslib.lex.Lexer</span></code></a></p>
<p>Example lexer which will split input stream into words (respecting
quotes)</p>
<p>To emit SPACE tokens: self.spacetok = (‘SPACE’,None)
To emit NL tokens: self.nltok = (‘NL’,None)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">WordLexer</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;abc &quot;def@=\. ghi&quot; jkl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">[(&#39;ATOM&#39;, &#39;abc&#39;), (&#39;ATOM&#39;, &#39;def@=. ghi&#39;), (&#39;ATOM&#39;, &#39;jkl&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">WordLexer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;1 &#39;2 3 4&#39; 5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">[(&#39;ATOM&#39;, &#39;1&#39;), (&#39;ATOM&#39;, &#39;2 3 4&#39;), (&#39;ATOM&#39;, &#39;5&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">WordLexer</span><span class="p">(</span><span class="s2">&quot;abc# a comment&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">[(&#39;ATOM&#39;, &#39;abc&#39;), (&#39;COMMENT&#39;, &#39;a comment&#39;)]</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.commentchars">
<code class="descname">commentchars</code><em class="property"> = set(['#'])</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.commentchars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexComment">
<code class="descname">lexComment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexComment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexNL">
<code class="descname">lexNL</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexNL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexQuote">
<code class="descname">lexQuote</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexQuote" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexSpace">
<code class="descname">lexSpace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexSpace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexStart">
<code class="descname">lexStart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexStart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.lex.WordLexer.lexWord">
<code class="descname">lexWord</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.lexWord" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.nlchars">
<code class="descname">nlchars</code><em class="property"> = set(['\n', '\r'])</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.nlchars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.nltok">
<code class="descname">nltok</code><em class="property"> = None</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.nltok" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.quotechars">
<code class="descname">quotechars</code><em class="property"> = set(['&quot;', &quot;'&quot;])</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.quotechars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.spacechars">
<code class="descname">spacechars</code><em class="property"> = set(['\t', ' ', '\x0b', '\x0c'])</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.spacechars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.spacetok">
<code class="descname">spacetok</code><em class="property"> = None</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.spacetok" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.lex.WordLexer.wordchars">
<code class="descname">wordchars</code><em class="property"> = set(['&quot;', '$', '&amp;', '(', '*', ',', '.', '0', '2', '4', '6', '8', ':', '&lt;', '&gt;', '&#64;', 'B', 'D', 'F', 'H', 'J', 'L', 'N', 'P', 'R', 'T', 'V', 'X', 'Z', '\\', '^', '`', 'b', 'd', 'f', 'h', 'j', 'l', 'n', 'p', 'r', 't', 'v', 'x', 'z', '|', '~', '!', '#', '%', &quot;'&quot;, ')', '+', '-', '/', '1', '3', '5', '7', '9', ';', '=', '?', 'A', 'C', 'E', 'G', 'I', 'K', 'M', 'O', 'Q', 'S', 'U', 'W', 'Y', '[', ']', '_', 'a', 'c', 'e', 'g', 'i', 'k', 'm', 'o', 'q', 's', 'u', 'w', 'y', '{', '}'])</em><a class="headerlink" href="#cft_code.dnslib.lex.WordLexer.wordchars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.pan_client">
<span id="cft-code-dnslib-pan-client-module"></span><h2>cft_code.dnslib.pan_client module<a class="headerlink" href="#module-cft_code.dnslib.pan_client" title="Permalink to this headline">¶</a></h2>
<p>DNS Client - DiG-like CLI utility.</p>
<p>Mostly useful for testing. Can optionally compare results from two
nameservers (–diff) or compare results against DiG (–dig).</p>
<p>Usage: python -m dnslib.client [options|–help]</p>
<p>See –help for usage.</p>
<dl class="function">
<dt id="cft_code.dnslib.pan_client.pan_dig">
<code class="descclassname">cft_code.dnslib.pan_client.</code><code class="descname">pan_dig</code><span class="sig-paren">(</span><em>domain</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.pan_client.pan_dig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.proxy">
<span id="cft-code-dnslib-proxy-module"></span><h2>cft_code.dnslib.proxy module<a class="headerlink" href="#module-cft_code.dnslib.proxy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cft_code.dnslib.proxy.PassthroughDNSHandler">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.proxy.</code><code class="descname">PassthroughDNSHandler</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em>, <em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.PassthroughDNSHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.DNSHandler</span></code></p>
<p>Modify DNSHandler logic (get_reply method) to send directly to 
upstream DNS server rather then decoding/encoding packet and
passing to Resolver (The request/response packets are still
parsed and logged but this is not inline)</p>
<dl class="method">
<dt id="cft_code.dnslib.proxy.PassthroughDNSHandler.get_reply">
<code class="descname">get_reply</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.PassthroughDNSHandler.get_reply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.proxy.ProxyResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.proxy.</code><code class="descname">ProxyResolver</code><span class="sig-paren">(</span><em>address</em>, <em>port</em>, <em>timeout=0</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.ProxyResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.BaseResolver</span></code></p>
<p>Proxy resolver - passes all requests to upstream DNS server and
returns response</p>
<p>Note that the request/response will be each be decoded/re-encoded 
twice:</p>
<ol class="loweralpha simple">
<li>Request packet received by DNSHandler and parsed into DNSRecord</li>
<li>DNSRecord passed to ProxyResolver, serialised back into packet 
and sent to upstream DNS server</li>
<li>Upstream DNS server returns response packet which is parsed into
DNSRecord</li>
<li>ProxyResolver returns DNSRecord to DNSHandler which re-serialises
this into packet and returns to client</li>
</ol>
<p>In practice this is actually fairly useful for testing but for a
‘real’ transparent proxy option the DNSHandler logic needs to be
modified (see PassthroughDNSHandler)</p>
<dl class="method">
<dt id="cft_code.dnslib.proxy.ProxyResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.ProxyResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.proxy.send_tcp">
<code class="descclassname">cft_code.dnslib.proxy.</code><code class="descname">send_tcp</code><span class="sig-paren">(</span><em>data</em>, <em>host</em>, <em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.send_tcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to send/receive DNS TCP request
(in/out packets will have prepended TCP length header)</p>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.proxy.send_udp">
<code class="descclassname">cft_code.dnslib.proxy.</code><code class="descname">send_udp</code><span class="sig-paren">(</span><em>data</em>, <em>host</em>, <em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.proxy.send_udp" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to send/receive DNS UDP request</p>
</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.ranges">
<span id="cft-code-dnslib-ranges-module"></span><h2>cft_code.dnslib.ranges module<a class="headerlink" href="#module-cft_code.dnslib.ranges" title="Permalink to this headline">¶</a></h2>
<p>Wrapper around property builtin to restrict attribute to defined
integer value range (throws ValueError).</p>
<p>Intended to ensure that values packed with struct are in the 
correct range</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">T</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">range_property</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">c</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">d</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">e</span> <span class="o">=</span> <span class="n">instance_property</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">bool</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">101</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;a&#39; must be between -100-100 [101]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">101</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;a&#39; must be between -100-100 [-101]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;blah&#39;</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;a&#39; must be between -100-100 [blah]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="mi">999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;e&#39; must be instance of ...</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check_range</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_range</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="mi">999</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;test&#39; must be between 0-255 [999]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">check_instance</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_instance</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;xxx&quot;</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Attribute &#39;test&#39; must be instance of ...</span>
</pre></div>
</div>
<dl class="function">
<dt id="cft_code.dnslib.ranges.B">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">B</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Unsigned Byte</p>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.BYTES">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">BYTES</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.BYTES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.H">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">H</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Unsigned Short</p>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.I">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">I</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.I" title="Permalink to this definition">¶</a></dt>
<dd><p>Unsigned Long</p>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.IP4">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">IP4</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.IP4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.IP6">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">IP6</code><span class="sig-paren">(</span><em>attr</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.IP6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.check_bytes">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">check_bytes</code><span class="sig-paren">(</span><em>name</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.check_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.check_instance">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">check_instance</code><span class="sig-paren">(</span><em>name</em>, <em>val</em>, <em>types</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.check_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.check_range">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">check_range</code><span class="sig-paren">(</span><em>name</em>, <em>val</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.check_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.instance_property">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">instance_property</code><span class="sig-paren">(</span><em>attr</em>, <em>types</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.instance_property" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.ntuple_range">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">ntuple_range</code><span class="sig-paren">(</span><em>attr</em>, <em>n</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.ntuple_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.ranges.range_property">
<code class="descclassname">cft_code.dnslib.ranges.</code><code class="descname">range_property</code><span class="sig-paren">(</span><em>attr</em>, <em>min</em>, <em>max</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.ranges.range_property" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.server">
<span id="cft-code-dnslib-server-module"></span><h2>cft_code.dnslib.server module<a class="headerlink" href="#module-cft_code.dnslib.server" title="Permalink to this headline">¶</a></h2>
<p>DNS server framework - intended to simplify creation of custom resolvers.</p>
<p>Comprises the following components:</p>
<blockquote>
<div><dl class="docutils">
<dt>DNSServer   - socketserver wrapper (in most cases you should just</dt>
<dd>need to pass this an appropriate resolver instance
and start in either foreground/background)</dd>
<dt>DNSHandler  - handler instantiated by DNSServer to handle requests</dt>
<dd><p class="first">The ‘handle’ method deals with the sending/receiving
packets (handling TCP length prefix) and delegates
the protocol handling to ‘get_reply’. This decodes
packet, hands off a DNSRecord to the Resolver instance, 
and encodes the returned DNSRecord.</p>
<p class="last">In most cases you dont need to change DNSHandler unless
you need to get hold of the raw protocol data in the
Resolver</p>
</dd>
<dt>DNSLogger   - The class provides a default set of logging functions for</dt>
<dd>the various stages of the request handled by a DNSServer
instance which are enabled/disabled by flags in the ‘log’
class variable.</dd>
<dt>Resolver    - Instance implementing a ‘resolve’ method that receives </dt>
<dd><p class="first">the decodes request packet and returns a response.</p>
<p>To implement a custom resolver in most cases all you need
is to implement this interface.</p>
<p class="last">Note that there is only a single instance of the Resolver
so need to be careful about thread-safety and blocking</p>
</dd>
</dl>
<p>The following examples use the server framework:</p>
<blockquote>
<div><dl class="docutils">
<dt>fixedresolver.py    - Simple resolver which will respond to all</dt>
<dd>requests with a fixed response</dd>
<dt>zoneresolver.py     - Resolver which will take a standard zone</dt>
<dd>file input</dd>
</dl>
<p>shellresolver.py    - Example of a dynamic resolver
proxy.py            - DNS proxy
intercept.py        - Intercepting DNS proxy</p>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resolver</span> <span class="o">=</span> <span class="n">BaseResolver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">DNSLogger</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">DNSServer</span><span class="p">(</span><span class="n">resolver</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">8053</span><span class="p">,</span><span class="n">address</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">start_thread</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.def&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">8053</span><span class="p">)</span>
<span class="go">Request: [...] (udp) / &#39;abc.def.&#39; (A)</span>
<span class="go">Reply: [...] (udp) / &#39;abc.def.&#39; (A) / NXDOMAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.def.                       IN      A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TestResolver</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">handler</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">reply</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">reply</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.def. 60 A 1.2.3.4&quot;</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">reply</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolver</span> <span class="o">=</span> <span class="n">TestResolver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span> <span class="o">=</span> <span class="n">DNSServer</span><span class="p">(</span><span class="n">resolver</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">8053</span><span class="p">,</span><span class="n">address</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span><span class="n">tcp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">start_thread</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">8053</span><span class="p">,</span><span class="n">tcp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Request: [...] (tcp) / &#39;abc.def.&#39; (A)</span>
<span class="go">Reply: [...] (tcp) / &#39;abc.def.&#39; (A) / RRs: A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.def.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.def.                60      IN      A       1.2.3.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<dl class="class">
<dt id="cft_code.dnslib.server.BaseResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">BaseResolver</code><a class="headerlink" href="#cft_code.dnslib.server.BaseResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base resolver implementation. Provides ‘resolve’ method which is
called by DNSHandler with the decode request (DNSRecord instance) 
and returns a DNSRecord instance as reply.</p>
<p>In most cases you should be able to create a custom resolver by
just replacing the resolve method with appropriate resolver code for
application (see fixedresolver/zoneresolver/shellresolver for
examples)</p>
<p>Note that a single instance is used by all DNSHandler instances so 
need to consider blocking &amp; thread safety.</p>
<dl class="method">
<dt id="cft_code.dnslib.server.BaseResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.BaseResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Example resolver - respond to all requests with NXDOMAIN</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.server.DNSHandler">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">DNSHandler</code><span class="sig-paren">(</span><em>request</em>, <em>client_address</em>, <em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">SocketServer.BaseRequestHandler</span></code></p>
<p>Handler for socketserver. Transparently handles both TCP/UDP requests
(TCP requests have length prepended) and hands off lookup to resolver
instance specified in &lt;SocketServer&gt;.resolver</p>
<dl class="method">
<dt id="cft_code.dnslib.server.DNSHandler.get_reply">
<code class="descname">get_reply</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSHandler.get_reply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSHandler.handle">
<code class="descname">handle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSHandler.handle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cft_code.dnslib.server.DNSHandler.udplen">
<code class="descname">udplen</code><em class="property"> = 0</em><a class="headerlink" href="#cft_code.dnslib.server.DNSHandler.udplen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.server.DNSLogger">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">DNSLogger</code><span class="sig-paren">(</span><em>log=''</em>, <em>prefix=True</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>The class provides a default set of logging functions for the various
stages of the request handled by a DNSServer instance which are
enabled/disabled by flags in the ‘log’ class variable.</p>
<p>To customise logging create an object which implements the DNSLogger
interface and pass instance to DNSServer.</p>
<p>The methods which the logger instance must implement are:</p>
<blockquote>
<div>log_recv          - Raw packet received
log_send          - Raw packet sent
log_request       - DNS Request
log_reply         - DNS Response
log_truncated     - Truncated
log_error         - Decoding error
log_data          - Dump full request/response</div></blockquote>
<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_data">
<code class="descname">log_data</code><span class="sig-paren">(</span><em>dnsobj</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_error">
<code class="descname">log_error</code><span class="sig-paren">(</span><em>handler</em>, <em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_pass">
<code class="descname">log_pass</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_pass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_prefix">
<code class="descname">log_prefix</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_recv">
<code class="descname">log_recv</code><span class="sig-paren">(</span><em>handler</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_recv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_reply">
<code class="descname">log_reply</code><span class="sig-paren">(</span><em>handler</em>, <em>reply</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_reply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_request">
<code class="descname">log_request</code><span class="sig-paren">(</span><em>handler</em>, <em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_send">
<code class="descname">log_send</code><span class="sig-paren">(</span><em>handler</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_send" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSLogger.log_truncated">
<code class="descname">log_truncated</code><span class="sig-paren">(</span><em>handler</em>, <em>reply</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSLogger.log_truncated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.server.DNSServer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">DNSServer</code><span class="sig-paren">(</span><em>resolver</em>, <em>address=''</em>, <em>port=53</em>, <em>tcp=False</em>, <em>logger=None</em>, <em>handler=&lt;class cft_code.dnslib.server.DNSHandler&gt;</em>, <em>server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Convenience wrapper for socketserver instance allowing
either UDP/TCP server to be started in blocking more
or as a background thread.</p>
<p>Processing is delegated to custom resolver (instance) and
optionally custom logger (instance), handler (class), and 
server (class)</p>
<p>In most cases only a custom resolver instance is required
(and possibly logger)</p>
<dl class="method">
<dt id="cft_code.dnslib.server.DNSServer.isAlive">
<code class="descname">isAlive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSServer.isAlive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSServer.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSServer.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSServer.start_thread">
<code class="descname">start_thread</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSServer.start_thread" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cft_code.dnslib.server.DNSServer.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.DNSServer.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.server.TCPServer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">TCPServer</code><span class="sig-paren">(</span><em>server_address</em>, <em>RequestHandlerClass</em>, <em>bind_and_activate=True</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.TCPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">SocketServer.ThreadingMixIn</span></code>, <code class="xref py py-class docutils literal"><span class="pre">SocketServer.TCPServer</span></code></p>
<dl class="attribute">
<dt id="cft_code.dnslib.server.TCPServer.allow_reuse_address">
<code class="descname">allow_reuse_address</code><em class="property"> = True</em><a class="headerlink" href="#cft_code.dnslib.server.TCPServer.allow_reuse_address" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cft_code.dnslib.server.UDPServer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.server.</code><code class="descname">UDPServer</code><span class="sig-paren">(</span><em>server_address</em>, <em>RequestHandlerClass</em>, <em>bind_and_activate=True</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.server.UDPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">SocketServer.ThreadingMixIn</span></code>, <code class="xref py py-class docutils literal"><span class="pre">SocketServer.UDPServer</span></code></p>
<dl class="attribute">
<dt id="cft_code.dnslib.server.UDPServer.allow_reuse_address">
<code class="descname">allow_reuse_address</code><em class="property"> = True</em><a class="headerlink" href="#cft_code.dnslib.server.UDPServer.allow_reuse_address" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.shellresolver">
<span id="cft-code-dnslib-shellresolver-module"></span><h2>cft_code.dnslib.shellresolver module<a class="headerlink" href="#module-cft_code.dnslib.shellresolver" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cft_code.dnslib.shellresolver.ShellResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.shellresolver.</code><code class="descname">ShellResolver</code><span class="sig-paren">(</span><em>routes</em>, <em>origin</em>, <em>ttl</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.shellresolver.ShellResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.BaseResolver</span></code></p>
<p>Example dynamic resolver. 
Maps DNS labels to shell commands and returns result as TXT record
(Note: No context is passed to the shell command)</p>
<p>Shell commands are passed in a a list in &lt;label&gt;:&lt;cmd&gt; format - eg:</p>
<blockquote>
<div>[ ‘uptime.abc.com.:uptime’, ‘ls:ls’ ]</div></blockquote>
<p>Would respond to requests to ‘uptime.abc.com.’ with the output
of the ‘uptime’ command.</p>
<p>For non-absolute labels the ‘origin’ parameter is prepended</p>
<dl class="method">
<dt id="cft_code.dnslib.shellresolver.ShellResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.shellresolver.ShellResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.test_decode">
<span id="cft-code-dnslib-test-decode-module"></span><h2>cft_code.dnslib.test_decode module<a class="headerlink" href="#module-cft_code.dnslib.test_decode" title="Permalink to this headline">¶</a></h2>
<p>Test dnslib packet encoding/decoding</p>
<p>Reads test files from dnslib/test (by default) containing 
dump of DNS exchange (packet dump &amp; parse output) and test 
round-trip parsing - specifically:</p>
<blockquote>
<div><ul class="simple">
<li>Parse packet data and zone format data and compare</li>
<li>Repack parsed packet data and compare with original</li>
</ul>
</div></blockquote>
<p>This should test the ‘parse’, ‘fromZone’ and ‘pack’ methods of the
associated record types.</p>
<p>The original parsed output is created using dnslib by default so systematic
encode/decode errors will not be found. By default the test data is
checked against ‘dig’ to ensure that it is correct when generated
using the –new option.</p>
<p>By default the module runs in ‘unittest’ mode (and supports unittest
–verbose/–failfast options)</p>
<p>The module can also be run in interactive mode (–interactive) and inspect
failed tests (–debug)</p>
<p>New test data files can be automatically created using the:</p>
<blockquote>
<div>–new &lt;domain&gt; &lt;type&gt;</div></blockquote>
<p>option. The data is checked against dig output and an error raised if
this does not match. This is effectively the same as running:</p>
<blockquote>
<div>python -m dnslib.client –query –hex –dig &lt;domain&gt; &lt;type&gt;</div></blockquote>
<p>It is possible to manually generate test data files using dnslib.client
even if the dig data doesn’t match (this is usually due to an unsupported
RDATA type which dnslib will output in hex rather then parsing contents).
The roundtrip tests will still work in this case (the unknown RDATA is
handled as an opaque blob).</p>
<p>In some cases the tests will fail as a result of the zone file parser
being more fragile than the packet parser (especially with broken data)</p>
<p>Note - unittests are dynamically generated from the test directory contents
(matched against the –glob parameter)</p>
<dl class="class">
<dt id="cft_code.dnslib.test_decode.TestContainer">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.test_decode.</code><code class="descname">TestContainer</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.test_decode.TestContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">unittest.case.TestCase</span></code></p>
</dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.test_decode.check_decode">
<code class="descclassname">cft_code.dnslib.test_decode.</code><code class="descname">check_decode</code><span class="sig-paren">(</span><em>f</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.test_decode.check_decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.test_decode.new_test">
<code class="descclassname">cft_code.dnslib.test_decode.</code><code class="descname">new_test</code><span class="sig-paren">(</span><em>domain</em>, <em>qtype</em>, <em>address='8.8.8.8'</em>, <em>port=53</em>, <em>nodig=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.test_decode.new_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.test_decode.print_errors">
<code class="descclassname">cft_code.dnslib.test_decode.</code><code class="descname">print_errors</code><span class="sig-paren">(</span><em>errors</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.test_decode.print_errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cft_code.dnslib.test_decode.test_generator">
<code class="descclassname">cft_code.dnslib.test_decode.</code><code class="descname">test_generator</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.test_decode.test_generator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib.zoneresolver">
<span id="cft-code-dnslib-zoneresolver-module"></span><h2>cft_code.dnslib.zoneresolver module<a class="headerlink" href="#module-cft_code.dnslib.zoneresolver" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cft_code.dnslib.zoneresolver.ZoneResolver">
<em class="property">class </em><code class="descclassname">cft_code.dnslib.zoneresolver.</code><code class="descname">ZoneResolver</code><span class="sig-paren">(</span><em>zone</em>, <em>glob=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.zoneresolver.ZoneResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dnslib.server.BaseResolver</span></code></p>
<p>Simple fixed zone file resolver.</p>
<dl class="method">
<dt id="cft_code.dnslib.zoneresolver.ZoneResolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>request</em>, <em>handler</em><span class="sig-paren">)</span><a class="headerlink" href="#cft_code.dnslib.zoneresolver.ZoneResolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Respond to DNS request - parameters are request packet &amp; handler.
Method is expected to return DNS response</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cft_code.dnslib">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cft_code.dnslib" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dnslib">
<h3>dnslib<a class="headerlink" href="#dnslib" title="Permalink to this headline">¶</a></h3>
<p>A library to encode/decode DNS wire-format packets supporting both 
Python 2.7 and Python 3.2+.</p>
<p>The library provides:</p>
<blockquote>
<div><ul class="simple">
<li>Support for encoding/decoding DNS packets between wire format,
python objects, and Zone/DiG textual representation (dnslib.dns)</li>
<li>A server framework allowing the simple creation of custom DNS 
resolvers (dnslib.server) and a number of example servers 
created using this framework</li>
<li>A number of utilities for testing (dnslib.client, dnslib.proxy,
dnslib.intercept)</li>
</ul>
</div></blockquote>
<p>Python 3 support was added in Version 0.9.0 which represented a fairly
major update to the library - the key changes include:</p>
<blockquote>
<div><ul class="simple">
<li>Python 2.7/3.2+ support (the last version supporting Python 2.6 
or earlier was version 0.8.3)</li>
<li>The ‘Bimap’ interface was changed significantly to explicitly 
split forward (value-&gt;text) lookups via __getitem__ and 
reverse (text-&gt;value) lookups via __getattr__. Applications
using the old interface will need to be updated.</li>
<li>Hostnames are now returned with a trailing dot by default (in
line with RFC)</li>
<li>Most object attributes are now typed in line with the record
definitions to make it harder to generate invalid packets</li>
<li>Support for encoding/decoding resource records in ‘Zone’ (BIND) 
file format</li>
<li>Support for encoding/decoding packets in ‘DiG’ format</li>
<li>Server framework allowing (in most cases) custom resolvers to
be created by just subclassing the DNSResolver class and 
overriding the ‘resolve’ method</li>
<li>A lot of fixes to error detection/handling which should make 
the library much more robust to invalid/unsupported data. The
library should now either return a valid DNSRecord instance
when parsing a packet or raise DNSError (tested via fuzzing)</li>
<li>Improved utilities (dnslib.client, dnslib.proxy, dnslib.intercept)</li>
<li>Improvements to encoding/decoding tests including the ability
to generate test data automatically in test_decode.py (comparing
outputs against DiG)</li>
<li>Ability to compare and diff DNSRecords</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p>The key DNS packet handling classes are in dnslib.dns and map to the 
standard DNS packet sections:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>DNSRecord - container for DNS packet. Contains:</dt>
<dd><ul class="first last">
<li>DNSHeader</li>
<li>Question section containing zero or more DNSQuestion objects</li>
<li>Answer section containing zero or more RR objects</li>
<li>Authority section containing zero or more RR objects</li>
<li>Additional section containing zero or more RR objects</li>
</ul>
</dd>
</dl>
</li>
<li>DNS RRs (resource records) contain an RR header and an RD object)</li>
<li>Specific RD types are implemented as subclasses of RD</li>
<li>DNS labels are represented by a DNSLabel class - in most cases
this handles conversion to/from textual representation however
does support arbitatry labels via a tuple of bytes objects</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>To decode a DNS packet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">packet</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;d5ad818000010005000000000377777706676f6f676c6503636f6d0000010001c00c0005000100000005000803777777016cc010c02c0001000100000005000442f95b68c02c0001000100000005000442f95b63c02c0001000100000005000442f95b67c02c0001000100000005000442f95b93&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;DNS Header: id=0xd5ad type=RESPONSE opcode=QUERY flags=RD,RA rcode=&#39;NOERROR&#39; q=1 a=5 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;www.google.com.&#39; qtype=A qclass=IN&gt;</span>
<span class="go">&lt;DNS RR: &#39;www.google.com.&#39; rtype=CNAME rclass=IN ttl=5 rdata=&#39;www.l.google.com.&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;www.l.google.com.&#39; rtype=A rclass=IN ttl=5 rdata=&#39;66.249.91.104&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;www.l.google.com.&#39; rtype=A rclass=IN ttl=5 rdata=&#39;66.249.91.99&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;www.l.google.com.&#39; rtype=A rclass=IN ttl=5 rdata=&#39;66.249.91.103&#39;&gt;</span>
<span class="go">&lt;DNS RR: &#39;www.l.google.com.&#39; rtype=A rclass=IN ttl=5 rdata=&#39;66.249.91.147&#39;&gt;</span>
</pre></div>
</div>
<p>The default text representation of the DNSRecord is in zone file format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 54701</span>
<span class="go">;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;www.google.com.                IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">www.google.com.         5       IN      CNAME   www.l.google.com.</span>
<span class="go">www.l.google.com.       5       IN      A       66.249.91.104</span>
<span class="go">www.l.google.com.       5       IN      A       66.249.91.99</span>
<span class="go">www.l.google.com.       5       IN      A       66.249.91.103</span>
<span class="go">www.l.google.com.       5       IN      A       66.249.91.147</span>
</pre></div>
</div>
<p>To create a DNS Request Packet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;google.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(This is equivalent to: d = DNSRecord(q=DNSQuestion(“google.com”) )</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;DNS Header: id=... type=QUERY opcode=QUERY flags=RD rcode=&#39;NOERROR&#39; q=1 a=0 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;google.com.&#39; qtype=A qclass=IN&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;google.com.                    IN      A</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;google.com&quot;</span><span class="p">,</span><span class="s2">&quot;MX&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(This is equivalent to: d = DNSRecord(q=DNSQuestion(“google.com”,QTYPE.MX) )</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: rd; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;google.com.                    IN      MX</span>
</pre></div>
</div>
<p>To create a DNS Response Packet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">(</span><span class="n">DNSHeader</span><span class="p">(</span><span class="n">qr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">aa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ra</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>              <span class="n">q</span><span class="o">=</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">),</span>
<span class="gp">... </span>              <span class="n">a</span><span class="o">=</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">&lt;DNS Header: id=... type=RESPONSE opcode=QUERY flags=AA,RD,RA rcode=&#39;NOERROR&#39; q=1 a=1 ns=0 ar=0&gt;</span>
<span class="go">&lt;DNS Question: &#39;abc.com.&#39; qtype=A qclass=IN&gt;</span>
<span class="go">&lt;DNS RR: &#39;abc.com.&#39; rtype=A rclass=IN ttl=0 rdata=&#39;1.2.3.4&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                0       IN      A       1.2.3.4</span>
</pre></div>
</div>
<p>It is also possible to create RRs from a string in zone file format</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com IN A 1.2.3.4&quot;</span><span class="p">)</span>
<span class="go">[&lt;DNS RR: &#39;abc.com.&#39; rtype=A rclass=IN ttl=0 rdata=&#39;1.2.3.4&#39;&gt;]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>(Note: this produces a list of RRs which should be unpacked if being</dt>
<dd><p class="first">passed to add_answer/add_auth/add_ar etc)</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="s2">&quot;abc.com 60 A 1.2.3.4&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      A</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      A       1.2.3.4</span>
</pre></div>
</div>
</dd>
</dl>
<p>The zone file can contain multiple entries and supports most of the normal
format defined in RFC1035 (specifically not $INCLUDE)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">        $TTL 300</span>
<span class="gp">... </span><span class="s1">        $ORIGIN abc.com</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        @       IN      MX      10  mail.abc.com.</span>
<span class="gp">... </span><span class="s1">        www     IN      A       1.2.3.4</span>
<span class="gp">... </span><span class="s1">                IN      TXT     &quot;Some Text&quot;</span>
<span class="gp">... </span><span class="s1">        mail    IN      CNAME   www.abc.com.</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">RR</span><span class="o">.</span><span class="n">fromZone</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">rr</span><span class="p">)</span>
<span class="go">abc.com.                300     IN      MX      10 mail.abc.com.</span>
<span class="go">www.abc.com.            300     IN      A       1.2.3.4</span>
<span class="go">www.abc.com.            300     IN      TXT     &quot;Some Text&quot;</span>
<span class="go">mail.abc.com.           300     IN      CNAME   www.abc.com.</span>
</pre></div>
</div>
<p>To create a skeleton reply to a DNS query:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">ANY</span><span class="p">))</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">reply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">),</span><span class="n">ttl</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      ANY</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      A       1.2.3.4</span>
</pre></div>
</div>
<p>Add additional RRs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;xxx.abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="s2">&quot;1.2.3.4&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="s2">&quot;xxx.abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">AAAA</span><span class="p">,</span><span class="n">rdata</span><span class="o">=</span><span class="n">AAAA</span><span class="p">(</span><span class="s2">&quot;1234:5678::1&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      ANY</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      A       1.2.3.4</span>
<span class="go">xxx.abc.com.            0       IN      A       1.2.3.4</span>
<span class="go">xxx.abc.com.            0       IN      AAAA    1234:5678::1</span>
</pre></div>
</div>
<p>It is also possible to create a reply from a string in zone file format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">ANY</span><span class="p">))</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">replyZone</span><span class="p">(</span><span class="s2">&quot;abc.com 60 IN CNAME xxx.abc.com&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      ANY</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                60      IN      CNAME   xxx.abc.com.</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DNSRecord</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pack</span><span class="p">()))</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">DNSRecord</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">DNSQuestion</span><span class="p">(</span><span class="s2">&quot;abc.com&quot;</span><span class="p">,</span><span class="n">QTYPE</span><span class="o">.</span><span class="n">ANY</span><span class="p">))</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">replyZone</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: ...</span>
<span class="go">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 0</span>
<span class="go">;; QUESTION SECTION:</span>
<span class="go">;abc.com.                       IN      ANY</span>
<span class="go">;; ANSWER SECTION:</span>
<span class="go">abc.com.                300     IN      MX      10 mail.abc.com.</span>
<span class="go">www.abc.com.            300     IN      A       1.2.3.4</span>
<span class="go">www.abc.com.            300     IN      TXT     &quot;Some Text&quot;</span>
<span class="go">mail.abc.com.           300     IN      CNAME   www.abc.com.</span>
</pre></div>
</div>
<p>The library also includes a simple framework for generating custom DNS
resolvers in dnslib.server (see module docs). In post cases this just 
requires implementing a custom ‘resolve’ method which receives a question 
object and returns a response.</p>
<p>A number of sample resolvers are provided as examples (see CLI –help):</p>
<blockquote>
<div><ul class="simple">
<li>dnslib.fixedresolver    - Respond to all requests with fixed response</li>
<li>dnslib.zoneresolver     - Respond from Zone file</li>
<li>dnslib.shellresolver    - Call shell script to generate response</li>
</ul>
</div></blockquote>
<p>The library includes a number of client utilities:</p>
<blockquote>
<div><ul>
<li><p class="first">DiG like client library</p>
<blockquote>
<div><p># python -m dnslib.client –help</p>
</div></blockquote>
</li>
<li><p class="first">DNS Proxy Server</p>
<blockquote>
<div><p># python -m dnslib.proxy –help</p>
</div></blockquote>
</li>
<li><p class="first">Intercepting DNS Proxy Server (replace proxy responses for specified domains)</p>
<blockquote>
<div><p># python -m dnslib.intercept –help</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="changelog">
<h3>Changelog:<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul>
<li><p class="first">0.1     2010-09-19  Initial Release</p>
</li>
<li><p class="first">0.2     2010-09-22  Minor fixes</p>
</li>
<li><p class="first">0.3     2010-10-02  Add DNSLabel class to support arbitrary labels (embedded ‘.’)</p>
</li>
<li><p class="first">0.4     2012-02-26  Merge with dbslib-circuits</p>
</li>
<li><dl class="first docutils">
<dt>0.5     2012-09-13  Add support for RFC2136 DDNS updates</dt>
<dd><p class="first last">Patch provided by Wesley Shields &lt;<a class="reference external" href="mailto:wxs&#37;&#52;&#48;FreeBSD&#46;org">wxs<span>&#64;</span>FreeBSD<span>&#46;</span>org</a>&gt; - thanks</p>
</dd>
</dl>
</li>
<li><p class="first">0.6     2012-10-20  Basic AAAA support</p>
</li>
<li><p class="first">0.7     2012-10-20  Add initial EDNS0 support (untested)</p>
</li>
<li><dl class="first docutils">
<dt>0.8     2012-11-04  Add support for NAPTR, Authority RR and additional RR</dt>
<dd><p class="first last">Patch provided by Stefan Andersson (<a class="reference external" href="https://bitbucket.org/norox">https://bitbucket.org/norox</a>) - thanks</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>0.8.1   2012-11-05  Added NAPTR test case and fixed logic error</dt>
<dd><p class="first last">Patch provided by Stefan Andersson (<a class="reference external" href="https://bitbucket.org/norox">https://bitbucket.org/norox</a>) - thanks</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>0.8.2   2012-11-11  Patch to fix IPv6 formatting</dt>
<dd><p class="first last">Patch provided by Torbjörn Lönnemark (<a class="reference external" href="https://bitbucket.org/tobbezz">https://bitbucket.org/tobbezz</a>) - thanks</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>0.8.3   2013-04-27  Don’t parse rdata if rdlength is 0</dt>
<dd><p class="first last">Patch provided by Wesley Shields &lt;<a class="reference external" href="mailto:wxs&#37;&#52;&#48;FreeBSD&#46;org">wxs<span>&#64;</span>FreeBSD<span>&#46;</span>org</a>&gt; - thanks</p>
</dd>
</dl>
</li>
<li><p class="first">0.9.0   2014-05-05  Major update including Py3 support (see docs)</p>
</li>
<li><p class="first">0.9.1   2014-05-05  Minor fixes</p>
</li>
<li><dl class="first docutils">
<dt>0.9.2   2014-08-26  Fix Bimap handling of unknown mappings to avoid exception in printing</dt>
<dd><p class="first last">Add typed attributes to classes
Misc fixes from James Mills - thanks</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>0.9.3   2014-08-26  Workaround for argparse bug which raises AssertionError if [] is</dt>
<dd><p class="first last">present in option text (really?)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>0.9.4   2015-04-10  Fix to support multiple strings in TXT record </dt>
<dd><p class="first">Patch provided by James Cherry (<a class="reference external" href="https://bitbucket.org/james_cherry">https://bitbucket.org/james_cherry</a>) - thanks
NOTE: For consistency this patch changes the ‘repr’ output for</p>
<blockquote class="last">
<div><p>TXT records to always be quoted</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><p class="first">0.9.5   2015-10-27  Add threading &amp; timeout handling to DNSServer</p>
</li>
<li><dl class="first docutils">
<dt>0.9.6   2015-10-28  Replace strftime in RRSIG formatting to avoid possible locale issues</dt>
<dd><p class="first last">Identified by Bryan Everly - thanks</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="license">
<h3>License:<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>BSD</p>
</div>
<div class="section" id="author">
<h3>Author:<a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Paul Chakravarti (<a class="reference external" href="mailto:paul&#46;chakravarti&#37;&#52;&#48;gmail&#46;com">paul<span>&#46;</span>chakravarti<span>&#64;</span>gmail<span>&#46;</span>com</a>)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="master-repository-issues">
<h3>Master Repository/Issues:<a class="headerlink" href="#master-repository-issues" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://bitbucket.org/paulc/dnslib">https://bitbucket.org/paulc/dnslib</a>
(Cloned on GitHub: <a class="reference external" href="https://github.com/paulchakravarti/dnslib">https://github.com/paulchakravarti/dnslib</a>)</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Palo Alto Networks.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>